# 🧠 Linuxコマンド `taskset` の使い方

`taskset` は、**特定のプロセスに実行するCPUコアを指定（CPU affinityの設定）**するためのLinuxコマンドです。

---

## 🔧 基本構文

```bash
# 新しいプロセスを特定のCPUで起動
taskset [オプション] <マスク> <コマンド> [引数...]

# 既存のプロセスに対して適用
taskset [オプション] -p <マスク> <PID>
```

---

## 🧠 マスク（bitmask）とは？

CPUの割り当てを **バイナリのビット列**で指定します。

| マスク | 割り当てCPU |
|--------|--------------|
| `0x1`  | CPU0         |
| `0x3`  | CPU0とCPU1   |
| `0xF`  | CPU0〜CPU3   |

例: `0x3` は `0011` → CPU0とCPU1が有効。

---

## ✅ 使用例

### 1. 新しいコマンドを特定CPUで実行

```bash
taskset 0x1 ./my_program
```
➡️ `./my_program` を CPU0 のみで実行。

---

### 2. 既存のプロセスのCPU割り当てを確認

```bash
taskset -p <PID>
```

例：

```bash
taskset -p 12345
```
➡️ プロセス `12345` のCPU使用コアを確認。

---

### 3. 既存プロセスにCPU割り当てを変更

```bash
taskset -p 0x3 12345
```
➡️ プロセス `12345` を CPU0とCPU1に制限。

---

## 🧪 よくある応用例

### topでスレッドを見ながら操作

```bash
top -H -p <PID>
```

- 各スレッドごとの負荷を見ながら `taskset` で調整。
- マルチスレッドプログラムのチューニングに便利。

---

## 🧰 補足オプション

| オプション | 内容                       |
|------------|----------------------------|
| `-c`       | CPUを番号で直接指定       |
| `-p`       | 既存プロセスに対して操作  |
| `--help`   | ヘルプを表示              |

### 例: CPU番号指定（マスク不要）

```bash
taskset -c 0,1 ./my_program
```
➡️ CPU0とCPU1で実行。

---

## 🔍 実験・確認用の例

```bash
echo $$                  # 現在のシェルのPID
taskset -p $$            # 現在のCPU割り当てを確認
taskset -p 0x1 $$        # シェルをCPU0に制限
```

---

## 👨‍💻 開発やチューニングでの活用例

- **リアルタイム処理**の最適化（特定CPUに固定）
- **マルチスレッド**のコア競合を防ぐ
- **ベンチマーク測定の再現性確保**
- **仮想環境・Docker** での制限

---


